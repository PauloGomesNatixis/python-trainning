{% extends 'base.html' %}

{% block title %}Ticket List{% endblock %}

{% block content %}
<div class="search-container">
    <form method="GET" action="{% url 'ticket_list' %}">
        <input type="text" name="q" placeholder="Search tickets..." value="{{ request.GET.q }}">
        <button type="submit" class="button">Search</button>
    </form>
</div>

<h1>All Tickets</h1>

{% if tickets %}
    <ul>
        {% for ticket in tickets %}
        <li>
            <strong>{{ ticket.title }}</strong><br>
            {{ ticket.description }}<br>
            Status: {{ ticket.get_status_display }}<br>
            Created: {{ ticket.created_at }}<br>
            <a href="{% url 'ticket_detail' ticket.pk %}">View Details<br><br></a>
            
            {% if user.is_staff %}
                <a href="{% url 'edit_ticket' ticket.id %}">Edit</a>  
            {% endif %}
        </li>
        {% endfor %}
    </ul>
{% else %}
    <p>No tickets found.</p>
{% endif %}
{% endblock %}
